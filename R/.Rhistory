past(levels(factor(df$YYYYMM)),collapse=" ")
paste(levels(factor(df$YYYYMM)),collapse=" ")
paste(levels(factor(df$State)),collapse=" ")
paste(levels(factor(df$State)),collapse=",")
D1<-data.frame(paste(levels(factor(df$State)),collapse=","))
D1
names(D1)
D1<-data.frame()
D1<-data.frame()
names(D1)<-paste(levels(factor(df$State)),collapse=",")
length(levels(factor(df$State)))
D1<-data.frame()[1:length(counter),1:length(levels(factor(df$State)))]
counter<-levels(factor(df$YYYYMM))
D1<-data.frame()[1:length(counter),1:length(levels(factor(df$State)))]
D1<-data.frame[1:4,]
D1<-data.frame[1:4,1:5]
D2<-data.frame[1:4,1:5]
D2<-data.frame()[1:4,1:5]
D1<- as.data.frame (matrix (nrow = length(counter),
ncol = length(levels(factor(df$State))))
D1<- as.data.frame (matrix (nrow = length(counter),
ncol = length(levels(factor(df$State)))))
D1
names(D1)<-paste(levels(factor(df$State)),collapse=",")
names(D1)
names(D1)<-c(paste(levels(factor(df$State)),collapse=","))
names(D1)
names(D1)<-c(levels(factor(df$State)))
names(D1)
D1
View(`D1`)
D1$names(D1)[1]
names(D1)[1]
D1[,names(D1)[1]]
D1[,names(D1)[1]][1]
D1[,names(D1)[1]][2]
D1[1,names(D1)[1]]
names(D1)[1:2]
counter<-levels(factor(df$YYYYMM))
D1<-as.data.frame (matrix (nrow = length(counter),
ncol = length(levels(factor(df$State)))))
names(D1)<-c(levels(factor(df$State)))
for(i in 1:length(counter)){
for(k %in% names(D1)[1:2] {
D1$k<-
sum(df[df$Empst=="Unemployed" & (df$Age>24 & df$Age<65) &
df$YYYYMM == counter[i],]$Weight) /
sum(df[df$Empst %in% c("Employed","Unemployed") &
(df$Age>24 & df$Age<65) &
df$YYYYMM == counter[i],]$Weight)
}
}
counter<-levels(factor(df$YYYYMM))
D1<-as.data.frame (matrix (nrow = length(counter),
ncol = length(levels(factor(df$State)))))
names(D1)<-c(levels(factor(df$State)))
for(i in 1:length(counter)){
for(k %in% names(D1)[1:2]) {
D1$k<-
sum(df[df$Empst=="Unemployed" & (df$Age>24 & df$Age<65) &
df$YYYYMM == counter[i],]$Weight) /
sum(df[df$Empst %in% c("Employed","Unemployed") &
(df$Age>24 & df$Age<65) &
df$YYYYMM == counter[i],]$Weight)
}
}
for(i in 1:length(counter)){
for(k %in% names(D1)[1:2]) {
D1$k<-
sum(df[df$Empst=="Unemployed" & (df$Age>24 & df$Age<65) &
df$YYYYMM == counter[i],]$Weight) /
sum(df[df$Empst %in% c("Employed","Unemployed") &
(df$Age>24 & df$Age<65) &
df$YYYYMM == counter[i],]$Weight)
}
}
p<-names(D1)[1:2]
for(i in 1:length(counter)){
for(k %in% p) {
D1$k<-
sum(df[df$Empst=="Unemployed" & (df$Age>24 & df$Age<65) &
df$YYYYMM == counter[i],]$Weight) /
sum(df[df$Empst %in% c("Employed","Unemployed") &
(df$Age>24 & df$Age<65) &
df$YYYYMM == counter[i],]$Weight)
}
}
for(i in 1:length(counter)){
for(k in p) {
D1$k<-
sum(df[df$Empst=="Unemployed" & (df$Age>24 & df$Age<65) &
df$YYYYMM == counter[i],]$Weight) /
sum(df[df$Empst %in% c("Employed","Unemployed") &
(df$Age>24 & df$Age<65) &
df$YYYYMM == counter[i],]$Weight)
}
}
View(`D1`)
for(i in 1:length(counter)){
for(k %in% p) {
D1$k<-
sum(df[df$Empst=="Unemployed" & (df$Age>24 & df$Age<65) &
df$YYYYMM == counter[i],]$Weight) /
sum(df[df$Empst %in% c("Employed","Unemployed") &
(df$Age>24 & df$Age<65) &
df$YYYYMM == counter[i],]$Weight)
}
}
for(k in names(D1)){show(k)}
for(i in 1:length(counter)){
for(k in 1:length(p)) {
D1[,k]<-
sum(df[df$Empst=="Unemployed" & (df$Age>24 & df$Age<65) &
df$YYYYMM == counter[i] &
df$State == names(D1)[k],]$Weight) /
sum(df[df$Empst %in% c("Employed","Unemployed") &
(df$Age>24 & df$Age<65) &
df$YYYYMM == counter[i] &
df$State == names(D1)[k],]$Weight)
}
}
View(`D1`)
for(i in 1:length(counter)){
for(k in 1:length(p)) {
D1[i,k]<-
sum(df[df$Empst=="Unemployed" & (df$Age>24 & df$Age<65) &
df$YYYYMM == counter[i] &
df$State == names(D1)[k],]$Weight) /
sum(df[df$Empst %in% c("Employed","Unemployed") &
(df$Age>24 & df$Age<65) &
df$YYYYMM == counter[i] &
df$State == names(D1)[k],]$Weight)
}
}
View(`D1`)
names(D1)<-c(levels(factor(df$State))+"Male")
names(D1)<-c(levels(factor(df$State)))+"Male"
c(levels(factor(df$State)))
names(D1)+"Male"
names(D1)[1]+"Male"
c(names(D1)[1]+"Male")
c(names(D1)[1],"Male")
paste(names(D1)[1],"Male")
paste(names(D1),"Male")
paste(names(D1),"Male",sep="")
paste(names(D1),"Male",sep="-")
names(D1)<-paste(names(D1),"Male",sep="-")
View(`D1`)
counter<-levels(factor(df$YYYYMM))
D1<-as.data.frame (matrix (nrow = length(counter),
ncol = length(levels(factor(df$State)))))
names(D1)<-c(levels(factor(df$State)))
names(D1)<-paste(names(D1),"Male",sep="-")
counter<-levels(factor(df$YYYYMM))
D1m<-as.data.frame (matrix (nrow = length(counter),
ncol = length(levels(factor(df$State)))))
names(D1m)<-c(levels(factor(df$State)))
names(D1m)<-paste(names(D1m),"Male",sep="-")
rm(D1)
rm(p)
gc(TRUE)
for(i in 1:length(counter)){
for(k in 1:names(D1m) {
D1m[i,k]<-
sum(df[df$Empst=="Unemployed" & (df$Age>24 & df$Age<65) &
df$Gender == "Male" &
df$YYYYMM == counter[i] &
df$State == names(D1m)[k],]$Weight) /
sum(df[df$Empst %in% c("Employed","Unemployed") &
(df$Age>24 & df$Age<65) &
df$Gender == "Male"
df$YYYYMM == counter[i] &
df$State == names(D1m)[k],]$Weight)
}
}
save.image("~/Desktop/wdCPS/CPSresearch.RData")
for(i in 1:length(counter)){
for(k in 1:names(D1m)) {
D1m[i,k]<-
sum(df[df$Empst=="Unemployed" & (df$Age>24 & df$Age<65) &
df$Gender == "Male" &
df$YYYYMM == counter[i] &
df$State == names(D1m)[k],]$Weight) /
sum(df[df$Empst %in% c("Employed","Unemployed") &
(df$Age>24 & df$Age<65) &
df$Gender == "Male"
df$YYYYMM == counter[i] &
df$State == names(D1m)[k],]$Weight)
}
}
for(i in 1:length(counter)){
for(k in 1:length(names(D1m))) {
D1m[i,k]<-
sum(df[df$Empst=="Unemployed" & (df$Age>24 & df$Age<65) &
df$Gender == "Male" &
df$YYYYMM == counter[i] &
df$State == names(D1m)[k],]$Weight) /
sum(df[df$Empst %in% c("Employed","Unemployed") &
(df$Age>24 & df$Age<65) &
df$Gender == "Male"
df$YYYYMM == counter[i] &
df$State == names(D1m)[k],]$Weight)
}
}
for(i in 1:length(counter)){
for(k in 1:length(names(D1m))) {
D1m[i,k]<-
sum(df[df$Empst=="Unemployed" & (df$Age>24 & df$Age<65) &
df$Gender == "Male" &
df$YYYYMM == counter[i] &
df$State == names(D1m)[k],]$Weight) /
sum(df[df$Empst %in% c("Employed","Unemployed") &
(df$Age>24 & df$Age<65) &
df$Gender == "Male" &
df$YYYYMM == counter[i] &
df$State == names(D1m)[k],]$Weight)
}
}
View(`D1m`)
T<-table(df[df$Empst=="Unemployed",]$YYYYMM,df[df$Empst=="Unemployed",]$State)
T
?xtabs
?table
?summarize
summarize(df)
rm(D1)
rm(D1m)
rm(counter)
rm(k)
rm(i)
d<-cbind(df$YYYYMM,df$State,df$Weight)
d
head(d)
names(d)<-c("YYYYMM","State","Weight")
head(d)
names(d)
d<-as.data.frame(d)
head(d)
names(d)<-c("YYYYMM","State","Weight")
head(d)
View(data)
View(df)
head(df)
gc(TRUE)
head(d)
d$State<-df$State
head(d)
summary(d)
levels(factor(d$YYYYMM))
table(d$YYYYMM,d$State)
head(table(d$YYYYMM,d$State))
sum(d$Weight)
sum(d[d$YYYYMM==200804 & d$State=="Me"]$Weight)
sum(d[d$YYYYMM==200804 & d$State=="ME"]$Weight)
sum(d[d$YYYYMM==200804 & d$State=="ME",]$Weight)
rm(d)
rm(T)
save.image("~/Desktop/wdCPS/CPSresearch.RData")
load("~/Desktop/wdCPS/CPSresearch.RData")
tapply(df$weight, list(df$State, df$YYYYMM), sum)
tapply(df$Weight, list(df$State, df$YYYYMM), sum)
tapply(df$Weight, list(df$YYYYMM,df$State), sum)
class(tapply(df$Weight, list(df$YYYYMM,df$State), sum))
?taply
?tapply
class(tapply(df$Weight, list(df$YYYYMM,df$State), sum/sum(df$Weight)))
sum(df$Weight)
class(tapply(df$Weight, list(df$YYYYMM,df$State), sum/5884966607))
class(tapply(df$Weight, list(df$YYYYMM,df$State), FUN=sum/5884966607))
class(tapply(df$Weight, list(df$YYYYMM,df$State), FUN="sum/5884966607"))
tapply(df$Weight, list(df$YYYYMM,df$State), sum)/sum(df$Weight)
tapply(df$Weight, list(df$YYYYMM,df$State), sum)/sum(df$Weight)*100
tapply(df[df$Empst=="Unemployed",]$Weight, list(df[df$Empst=="Unemployed",]$YYYYMM,df[df$Empst=="Unemployed",]$State), sum)/sum(df[df$Empstin c("Unemployed",Employed),]$Weight)*100
tapply(df[df$Empst=="Unemployed",]$Weight, list(df[df$Empst=="Unemployed",]$YYYYMM,df[df$Empst=="Unemployed",]$State), sum)/sum(df[df$Empst in c("Unemployed",Employed),]$Weight)*100
tapply(df[df$Empst=="Unemployed",]$Weight,
list(df[df$Empst=="Unemployed",]$YYYYMM,
df[df$Empst=="Unemployed",]$State), sum) /
sum(df[df$Empst in("Unemployed","Employed"),]$Weight)*100
tapply(df[df$Empst=="Unemployed",]$Weight,
list(df[df$Empst=="Unemployed",]$YYYYMM,
df[df$Empst=="Unemployed",]$State), sum) /
sum(df[df$Empst in c("Unemployed","Employed"),]$Weight)*100
tapply(df[df$Empst=="Unemployed",]$Weight,
list(df[df$Empst=="Unemployed",]$YYYYMM,
df[df$Empst=="Unemployed",]$State), sum) /
sum(df[df$Empst %in% c("Unemployed","Employed"),]$Weight)*100
tapply(df[df$Empst=="Unemployed",]$Weight,
list(df$YYYYMM,df$State), sum) /
sum(df[df$Empst %in% c("Unemployed","Employed"),]$Weight)
tapply(df[df$Empst=="Unemployed",]$Weight,
list(df[df$Empst=="Unemployed",]$YYYYMM,
df[df$Empst=="Unemployed",]$State), sum) /
sum(df[df$Empst %in% c("Unemployed","Employed"),]$Weight)
tapply(df[df$Empst=="Unemployed",]$Weight,
list(df[df$Empst=="Unemployed",]$YYYYMM,
df[df$Empst=="Unemployed",]$State), sum)*100 /
sum(df[df$Empst %in% c("Unemployed","Employed"),]$Weight)
tapply(df[df$Empst=="Unemployed",]$Weight,
list(df[df$Empst=="Unemployed",]$YYYYMM,
df[df$Empst=="Unemployed",]$State),sum)
tapply(df[df$Empst %in% c("Unemployed","Employed"),]$Weight,
list(df[df$Empst %in% c("Unemployed","Employed"),]$YYYYMM,
df[df$Empst %in% c("Unemployed","Employed"),]$State),
sum)
T<-tapply(df[df$Empst=="Unemployed",]$Weight,
list(df[df$Empst=="Unemployed",]$YYYYMM,
df[df$Empst=="Unemployed",]$State),sum)
Th<-tapply(df[df$Empst %in% c("Unemployed","Employed"),]$Weight,
list(df[df$Empst %in% c("Unemployed","Employed"),]$YYYYMM,
df[df$Empst %in% c("Unemployed","Employed"),]$State),
sum)
T/Th
T<-tapply(df[df$Empst=="Unemployed",]$Weight,
list(df[df$Empst=="Unemployed",]$YYYYMM,
df[df$Empst=="Unemployed",]$State),sum) /
tapply(df[df$Empst %in% c("Unemployed","Employed"),]$Weight,
list(df[df$Empst %in% c("Unemployed","Employed"),]$YYYYMM,
df[df$Empst %in% c("Unemployed","Employed"),]$State),sum)
T<-T*100
T
T<-tapply(df[df$Empst=="Unemployed",]$Weight,
list(df[df$Empst=="Unemployed",]$YYYYMM,
df[df$Empst=="Unemployed",]$State),sum)
tapply(df[df$Empst %in% c("Unemployed","Employed"),]$Weight,
list(df[df$Empst %in% c("Unemployed","Employed"),]$YYYYMM,
df[df$Empst %in% c("Unemployed","Employed"),]$State),sum)
T
31514.67/699507.0
31514.67/699507.0
62026.30/683403.0
T<-tapply(df[df$Empst=="Unemployed",]$Weight,
list(df[df$Empst=="Unemployed",]$YYYYMM,
df[df$Empst=="Unemployed",]$State),sum) /
tapply(df[df$Empst %in% c("Unemployed","Employed"),]$Weight,
list(df[df$Empst %in% c("Unemployed","Employed"),]$YYYYMM,
df[df$Empst %in% c("Unemployed","Employed"),]$State),sum)
T
T<-T*100
T
T<-tapply(df[df$Empst=="Unemployed" & df$Gender=="Male",]$Weight,
list(df[df$Empst=="Unemployed" & df$Gender=="Male",]$YYYYMM,
df[df$Empst=="Unemployed" & df$Gender=="Male",],]$State),sum) /
tapply(df[df$Empst %in% c("Unemployed","Employed") & df$Gender=="Male",],]$Weight,
list(df[df$Empst %in% c("Unemployed","Employed") & df$Gender=="Male",],]$YYYYMM,
df[df$Empst %in% c("Unemployed","Employed") & df$Gender=="Male",],]$State),sum)
T<-T*100
T<-tapply(df[df$Empst=="Unemployed" & df$Gender=="Male",]$Weight,
list(df[df$Empst=="Unemployed" & df$Gender=="Male",]$YYYYMM,
df[df$Empst=="Unemployed" & df$Gender=="Male",]$State),sum) /
tapply(df[df$Empst %in% c("Unemployed","Employed") & df$Gender=="Male",]$Weight,
list(df[df$Empst %in% c("Unemployed","Employed") & df$Gender=="Male",]$YYYYMM,
df[df$Empst %in% c("Unemployed","Employed") & df$Gender=="Male",]$State),sum)
T<-T*100
T
temp<-melt(T,id=T[,1], variable_name="series")
gr3<-ggplot(temp, aes(time,value)) + geom_line(aes(colour = series))
require(reshape)
require(ggplot)
require(ggplot2)
temp<-melt(T,id=T[,1], variable_name="series")
gr3<-ggplot(temp, aes(time,value)) + geom_line(aes(colour = series))
gr3
temp
gr3<-ggplot(temp, aes(time,value)) + geom_line(aes(colour = series))
gr3
gr3<-ggplot(temp, aes(T[,1],value)) + geom_line(aes(colour = series))
gr3
temp<-melt(T,id=T[,1], variable_name="series")
gr3<-ggplot(temp, aes(T[,1],value)) + geom_line(aes(colour = series))
gr3
head(temp)
temp<-melt(T,id=T[,1], variable_name="series")
head(temp)
temp<-melt(T,id=T[,1], variable_name='series')
head(temp)
class(T)
T<-as.dataframe(T)
matplot(T)
T<-as.data.frame(T)
head(T)
temp<-melt(T,id=T[,1], variable_name='series')
head(temp)
gr3<-ggplot(temp, aes(T[,1],value)) + geom_line(aes(colour = series))
gr3
names(T)[1]<-"YYYYMM"
temp<-melt(T,id="YYYYMM", variable_name='series')
head(temp)
T<-as.data.frame(T)
T
names(T)[1]<-"YYYYMM"
T
names(T)[0]<-"YYYYMM"
T
T<-tapply(df[df$Empst=="Unemployed" & df$Gender=="Male",]$Weight,
list(df[df$Empst=="Unemployed" & df$Gender=="Male",]$YYYYMM,
df[df$Empst=="Unemployed" & df$Gender=="Male",]$State),sum) /
tapply(df[df$Empst %in% c("Unemployed","Employed") & df$Gender=="Male",]$Weight,
list(df[df$Empst %in% c("Unemployed","Employed") & df$Gender=="Male",]$YYYYMM,
df[df$Empst %in% c("Unemployed","Employed") & df$Gender=="Male",]$State),sum)
T<-T*100
T<-as.data.frame(T)
T
head(T)
names(T)
T[1,1]
T[0,1]
T[1,0]
T<-tapply(df[df$Empst=="Unemployed" & df$Gender=="Male",]$Weight,
list(df[df$Empst=="Unemployed" & df$Gender=="Male",]$YYYYMM,
df[df$Empst=="Unemployed" & df$Gender=="Male",]$State),sum) /
tapply(df[df$Empst %in% c("Unemployed","Employed") & df$Gender=="Male",]$Weight,
list(df[df$Empst %in% c("Unemployed","Employed") & df$Gender=="Male",]$YYYYMM,
df[df$Empst %in% c("Unemployed","Employed") & df$Gender=="Male",]$State),sum)
head(T)
names(T)
T[1,]
T[,1]
T[,1][1]
T[,1][[1]]
as.data.frame(as.table(T))
head(as.data.frame(as.table(T)))
T<-T*100
names(T)<-c("YYYYMM","State","UnR")
head(T)
T<-as.data.frame(as.table(T))
names(T)<-c("YYYYMM","State","UnR")
head(T)
gr3<-ggplot(temp, aes(YYYYMM,UnR)) + geom_line(aes(colour = State))
gr3
gr3<-ggplot(T, aes(YYYYMM,UnR)) + geom_line(aes(colour = State))
gr3
gr3<-ggplot(T, aes(YYYYMM,UnR,group=1)) + geom_line(aes(colour = State))
gr3
gr33<-ggplot(T, aes(YYYYMM,UnR,group=1)) + geom_line() + facet_grid(State ~ .)
gr33
gr3
gr3<-ggplot(T, aes(YYYYMM,UnR,group=1)) + geom_line(aes(colour = State))
gr3
head(T)
gr3<-ggplot(T, aes(YYYYMM,UnR,group=1)) + geom_line(aes(colour = T$State))
gr3
gr3<-ggplot(T, aes(YYYYMM,UnR,group=State)) + geom_line(aes(colour = T$State))
gr3
gr33<-ggplot(T, aes(YYYYMM,UnR,group=State)) + geom_line() + facet_grid(State ~ .)
gr33
gr3
load("/Users/Koba/Desktop/ECON322Paper/R/minWage.RData")
head(d)
setwd("~/Desktop/ECON322Paper/R")
unemp<-rate(dPA,2,dPA$PTERNHLY>-0.02,-0.02)
unemp<-data.frame(unemp)
unemps<-ts(unemp$unemp,start=c(2005,1),frequency=12)
decunemp<-decompose(unemps)
unempk<-ggplot(unemp,aes(x=rownames(unemp),y=data.frame(unemps-decunemp$seasonal)$unemp))+geom_point()+
geom_line(aes(y=data.frame(unemps-decunemp$seasonal)$unemp,group=1))+
geom_line(aes(y=decunemp$trend,group=1),col="blue")+
theme(axis.text.x=element_text(angle = 75, hjust = 1))
library(weights)
library(plotrix)
library(ggplot2)
library(forecast)
library(gridExtra)
unemp<-rate(dPA,2,dPA$PTERNHLY>-0.02,-0.02)
unemp<-data.frame(unemp)
unemps<-ts(unemp$unemp,start=c(2005,1),frequency=12)
decunemp<-decompose(unemps)
unempk<-ggplot(unemp,aes(x=rownames(unemp),y=data.frame(unemps-decunemp$seasonal)$unemp))+geom_point()+
geom_line(aes(y=data.frame(unemps-decunemp$seasonal)$unemp,group=1))+
geom_line(aes(y=decunemp$trend,group=1),col="blue")+
theme(axis.text.x=element_text(angle = 75, hjust = 1))
unempk
unempk<-ggplot(unemp,aes(x=rownames(unemp),y=data.frame(unemps-decunemp$seasonal)$unemp))+geom_point()+
ggtitle("Unemployment rate in the Food Services and Drinking Places industry in PA") +
theme(plot.title = element_text(size=18,face="bold"))+
xlab("Period")+ylab("Rate,%")+
geom_line(aes(y=data.frame(unemps-decunemp$seasonal)$unemp,group=1))+
geom_line(aes(y=decunemp$trend,group=1),col="blue")+
scale_x_discrete(breaks=grBreaks,labels=grBreaks) +
theme(axis.text.x=element_text(angle = 75, hjust = 1),
axis.text=element_text(size=12),
axis.title=element_text(size=14,face="bold"))
unemp
unempk
emp<-rate(dPA,1,dPA$PTERNHLY>-0.02,-0.02)
emp<-data.frame(emp)
emps<-ts(emp$emp,start=c(2005,1),frequency=12)
decemp<-decompose(emps)
empk<-ggplot(emp,aes(x=rownames(emp),y=data.frame(emps-decemp$seasonal)$emp))+
ggtitle("Employment rate in the Food Services and Drinking Places industry in PA") +
theme(plot.title = element_text(size=18,face="bold"))+
xlab("Period")+ylab("Rate,%")+
geom_point()+
geom_line(aes(y=data.frame(emps-decemp$seasonal)$emp,group=1))+
geom_line(aes(y=decemp$trend,group=1),col="blue")+
theme(axis.text.x=element_text(angle = 75, hjust = 1))
grid.arrange(empkm,unempk,ncol=2)
grid.arrange(empk,unempk,ncol=2)
grid.arrange(empk,unempk,nrow=2)
empk<-ggplot(emp,aes(x=rownames(emp),y=data.frame(emps-decemp$seasonal)$emp))+
ggtitle("Employment rate in the Food Services and Drinking Places industry in PA") +
theme(plot.title = element_text(size=18,face="bold"))+
xlab("Period")+ylab("Rate,%")+
geom_point()+
geom_line(aes(y=data.frame(emps-decemp$seasonal)$emp,group=1))+
geom_line(aes(y=decemp$trend,group=1),col="blue")+
scale_x_discrete(breaks=grBreaks,labels=grBreaks) +
theme(axis.text.x=element_text(angle = 75, hjust = 1),
axis.text=element_text(size=12),
axis.title=element_text(size=14,face="bold"))
grid.arrange(empk,unempk,nrow=2)
mod1<-lm(emp[-96:-95]~criyearDummy[-96:-95] + minwageDummy[-96:-95] + foodSalesGrowth[-1:-2],emp)
summary(mod1)
